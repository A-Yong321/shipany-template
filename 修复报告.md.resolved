# URL 导航修复报告

## 1. 问题描述
用户反馈在点击首页或特效列表页（Video Effects / Photo Effects）的卡片时，经常出现 404 错误。

### 症状
- 点击某些特效卡片跳转到如 `/video-effects/aikissing法式接吻` 的页面，导致 404。
- 点击 "Mimic" (模仿) 类特效跳转到错误的非规范路径。

## 2. 根本原因 (Root Cause)
问题的核心在于**配置数据 (JSON) 与代码逻辑/规范定义 (tools.ts) 不一致**。

1.  **URL 硬编码错误**：
    在 [src/config/locale/messages/zh/pages/video-effects.json](file:///d:/shipany-template/src/config/locale/messages/zh/pages/video-effects.json) 等文件中，`url` 字段被手动硬编码为包含中文或非规范格式的字符串，例如：
    - 错误：`/video-effects/aikissing法式接吻`
    - 错误：`/video-effects/ai-twerk` (此 slug 在系统中不存在，属于 `ai-mimic` 的变体)

2.  **Canonical Slugs 忽视**：
    前端路由 ([src/app/[locale]/(landing)/video-effects/page.tsx](file:///d:/shipany-template/src/app/%5Blocale%5D/%28landing%29/video-effects/page.tsx)) 依赖于通用的 `DynamicPage` 组件渲染，该组件直接使用 JSON 中的 URL。如果 JSON 中的 URL 不匹配 [src/data/tools.ts](file:///d:/shipany-template/src/data/tools.ts) 中定义的 `slug`，或者不匹配 Next.js 的文件系统路由，就会导致 404。

3.  **JSON 语法与键名错误**：
    - [photo-effect-details.json](file:///d:/shipany-template/src/config/locale/messages/en/pages/photo-effect-details.json) 中存在多余的 Markdown 格式符号。
    - [video-effect-details.json](file:///d:/shipany-template/src/config/locale/messages/en/pages/video-effect-details.json) 中的键名 (如 `mimic`) 与规范 slug (`ai-mimic`) 不匹配。

## 3. 修复方案

### 3.1 规范化 URL (Normalization)
我们将所有 JSON 配置文件中的 URL 统一修正为 [tools.ts](file:///d:/shipany-template/src/data/tools.ts) 中定义的 **Canonical Slug** 加上 **Query Parameter** 的形式。

**规则：**
- **基础路径**：必须对应 [tools.ts](file:///d:/shipany-template/src/data/tools.ts) 中的顶级 `slug`。
- **特定变体**：使用 `?type=` 参数指定具体特效名称。

**修改示例 (Video Effects)：**

| 原始错误 URL | 修正后 URL | 说明 |
| :--- | :--- | :--- |
| `/video-effects/aikissing法式接吻` | `/video-effects/ai-kissing?type=法式接吻` | 使用 `ai-kissing` 作为基础 slug |
| `/video-effects/ai-twerk` | `/video-effects/ai-mimic?type=扭臀舞`  | `ai-twerk` 归属于 `ai-mimic` 工具 |
| `/video-effects/模仿-reze舞` | `/video-effects/ai-mimic?type=Reze舞` | 统一归类到 `ai-mimic` |
| `/video-effects/视觉效果-ai爆炸效果` | `/video-effects/ai-visual-effects?type=AI爆炸效果` | 统一归类到 `ai-visual-effects` |

**修改示例 (Photo Effects)：**

| 原始错误 URL | 修正后 URL | 说明 |
| :--- | :--- | :--- |
| `/photo-effects/ai-fake-date` | `/photo-effects/ai-fake-date-photo` | 对应正确的 Photo 工具 slug |
| `/photo-effects/角色切换-ai老虎拥抱` | `/photo-effects/ai-role-swap-photo?type=AI老虎拥抱` | 统一归类到 `ai-role-swap-photo` |

### 3.2 修正涉及文件
- [src/config/locale/messages/zh/landing.json](file:///d:/shipany-template/src/config/locale/messages/zh/landing.json)
- [src/config/locale/messages/en/landing.json](file:///d:/shipany-template/src/config/locale/messages/en/landing.json)
- [src/config/locale/messages/zh/pages/video-effects.json](file:///d:/shipany-template/src/config/locale/messages/zh/pages/video-effects.json)
- [src/config/locale/messages/en/pages/video-effects.json](file:///d:/shipany-template/src/config/locale/messages/en/pages/video-effects.json)
- [src/config/locale/messages/zh/pages/photo-effects.json](file:///d:/shipany-template/src/config/locale/messages/zh/pages/photo-effects.json)
- [src/config/locale/messages/en/pages/photo-effects.json](file:///d:/shipany-template/src/config/locale/messages/en/pages/photo-effects.json)

### 3.3 修正详情页映射
为了确保详情页能正确渲染内容，修正了详情页配置文件的键名：
- `src/config/locale/messages/*/pages/video-effect-details.json`: `mimic` -> `ai-mimic`, `role-swap` -> `ai-role-swap`
- `src/config/locale/messages/*/pages/photo-effect-details.json`: 移除了错误的 markdown 标记，确保键名如 `ai-role-swap-photo` 存在。

## 4. 后续维护指南 (参考)

为防止此类问题再次发生，添加新特效或页面时请遵循以下步骤：

1.  **查阅 [src/data/tools.ts](file:///d:/shipany-template/src/data/tools.ts)**：
    这是**唯一的数据源** (Single Source of Truth)。新增特效必须先在这里定义或找到所属的工具。

2.  **构建 URL**：
    - 格式：`/{category}/{tool-slug}?type={effect-name}`
    - `{category}`: `video-effects` 或 `photo-effects`
    - `{tool-slug}`: 必须完全匹配 [tools.ts](file:///d:/shipany-template/src/data/tools.ts) 中的 `slug` 字段。
    - `{effect-name}`: 对应 UI 显示的具体特效名称。

3.  **不要创造新的 Slug**：
    不要在 JSON 中随意创造如 `ai-twerk` 这样的 slug，除非你在代码中确实创建了对应的路由文件夹 (`src/app/[locale]/(main)/video-effects/ai-twerk/page.tsx`)。如果只是同一个工具下的不同效果，**必须**使用 Query Parameter (`?type=...`)。

4.  **多语言同步**：
    修改中文 JSON (`zh`) 时，务必同步修改英文 JSON ([en](file:///d:/shipany-template/src/app/%5Blocale%5D/%28landing%29/photo-effects/%5Bslug%5D/page.tsx#8-29))，URL 结构必须保持一致（仅 `type` 参数的值可能不同，取决于是否翻译了 type 值）。
